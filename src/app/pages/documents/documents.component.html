<div class="documents-page">
  <div class="documents-container">
    <div class="page-header">
      <h1>Documents</h1>
      <p class="subtitle">Manage your uploaded transcripts</p>
    </div>

    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>Loading documents...</p>
    </div>

    <div *ngIf="error" class="error-message">
      {{ error }}
    </div>

    <div *ngIf="!isLoading && !error" class="documents-content">
      <div class="documents-stats">
        <div class="stat-card">
          <span class="stat-number">{{ transcripts.length }}</span>
          <span class="stat-label">Total Documents</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">{{ getActiveCount() }}</span>
          <span class="stat-label">Active</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">{{ getInactiveCount() }}</span>
          <span class="stat-label">Inactive</span>
        </div>
      </div>

      <!-- Filter controls - always visible -->
      <div class="filter-section">
        <div class="filter-controls">
          <label for="filter-select" class="filter-label">Filter by status:</label>
          <select id="filter-select" [(ngModel)]="filterStatus" (change)="applyFilter()" class="filter-select">
            <option value="all">All Documents</option>
            <option value="active">Active Only</option>
            <option value="inactive">Inactive Only</option>
          </select>
        </div>
      </div>

      <div *ngIf="filteredTranscripts.length === 0 && !isLoading" class="empty-state">
        <div class="empty-icon">üìÑ</div>
        <h3>No documents found</h3>
        <p *ngIf="filterStatus === 'all'">Upload some documents to get started.</p>
        <p *ngIf="filterStatus === 'active'">No active documents found. Try switching to "All Documents" or "Inactive Only".</p>
        <p *ngIf="filterStatus === 'inactive'">No inactive documents found. Try switching to "All Documents" or "Active Only".</p>
        <a *ngIf="filterStatus === 'all'" routerLink="/upload" class="btn btn-primary">Upload Documents</a>
        <button *ngIf="filterStatus !== 'all'" (click)="filterStatus = 'all'; applyFilter()" class="btn btn-secondary">Show All Documents</button>
      </div>

      <div *ngIf="filteredTranscripts.length > 0" class="transcripts-list">
        <div class="list-header">
          <h3>Transcripts ({{ filteredTranscripts.length }})</h3>
        </div>

        <div class="transcript-cards">
          <div *ngFor="let transcript of filteredTranscripts" class="transcript-card">
            <div class="card-header">
              <h4 class="transcript-title">{{ transcript.title || 'Untitled Document' }}</h4>
              <div class="status-badge" [class.active]="transcript.active" [class.inactive]="!transcript.active">
                {{ transcript.active ? 'Active' : 'Inactive' }}
              </div>
            </div>
            
            <div class="card-content">
              <div class="transcript-info">
                <div class="info-item">
                  <span class="label">Trainer:</span>
                  <span class="value">{{ transcript.trainer_name || 'Not specified' }}</span>
                </div>
                <div class="info-item">
                  <span class="label">Uploaded:</span>
                  <span class="value">{{ formatDate(transcript.created_at) }}</span>
                </div>
                <div *ngIf="transcript.source_url" class="info-item">
                  <span class="label">Source:</span>
                  <a [href]="transcript.source_url" target="_blank" class="source-link">{{ transcript.source_url }}</a>
                </div>
                <div *ngIf="transcript.media_type" class="info-item">
                  <span class="label">Type:</span>
                  <span class="value">{{ transcript.media_type }}</span>
                </div>
              </div>
            </div>

            <div class="card-actions">
              <div class="action-group">
                <label class="toggle-switch">
                  <input 
                    type="checkbox" 
                    [checked]="transcript.active"
                    (change)="toggleActiveState(transcript)"
                    [disabled]="isUpdating[transcript.id]"
                  >
                  <span class="slider"></span>
                </label>
                <span class="toggle-label">
                  {{ transcript.active ? 'Deactivate' : 'Activate' }}
                </span>
              </div>
              
              <button 
                class="btn-delete"
                (click)="confirmDelete(transcript)"
                [disabled]="isUpdating[transcript.id]"
                title="Delete document"
              >
                üóëÔ∏è Delete
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <app-confirmation-modal
    [isVisible]="showDeleteModal"
    [isLoading]="isDeleting"
    [isDestructive]="true"
    title="Delete Document"
    [message]="getDeleteConfirmationMessage()"
    confirmText="Delete"
    cancelText="Cancel"
    (confirmed)="onDeleteConfirmed()"
    (cancelled)="onDeleteCancelled()"
  ></app-confirmation-modal>
</div>